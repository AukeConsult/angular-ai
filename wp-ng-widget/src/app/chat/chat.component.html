<div class="chat">


  <div #historyRef class="history">
    <div
      #msgItem
      *ngFor="let m of messages; let i = index; trackBy: trackByIndex"
      class="msg"
      [class.me]="m.role === 'user'"
      [class.ai]="m.role === 'assistant'"
      [class.err]="m.role === 'error'"
    >
      <div class="avatar" [class.user]="m.role === 'user'">
        {{ m.role === 'user' ? 'U' : m.role === 'assistant' ? 'A' : '!' }}
      </div>
      <div class="bubble">
        <div class="who">
          {{ m.role === 'user' ? 'You' : m.role === 'assistant' ? 'Assistant' : 'Error' }}
        </div>
        <div class="text">{{ m.content }}</div>
      </div>
    </div>

    <div *ngIf="isSending" class="typing">Assistant is typing…</div>
  </div>


  <footer class="composer">
    <!-- Helper line (only on empty chat & not typing) -->
    <div class="helper-question" *ngIf="isEmpty && !isComposing">
      Hva kan jeg hjelpe deg med? <span class="highlight">Spør om hva som helst ✨</span>
    </div>

    <!-- Input -->
    <div class="input-wrap">
    <textarea
      #inputRef
      class="input"
      [(ngModel)]="userMessage"
      name="message"
      rows="1"
      (keydown)="onComposerKeydown($event)"
      (input)="onTextareaInput()"
    ></textarea>

      <button
        class="send"
        type="button"
        [disabled]="isSending || !userMessage.trim()"
        (click)="send()"
        title="Send (Enter)"
      >
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M3 11L21 3L13 21L11 13L3 11Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>

    <!-- Rotating suggestion (only on empty chat & not typing) -->
    <div class="suggestion-rotator" *ngIf="isEmpty && !isComposing" (click)="applySuggestion()">
      <span class="suggestion-text" [class.swap]="animateSwap">{{ currentSuggestion }}</span>
    </div>

    <div class="hint">
      Press <kbd>Enter</kbd> to send • <kbd>Shift</kbd> + <kbd>Enter</kbd> for a new line
    </div>
  </footer>


</div>
